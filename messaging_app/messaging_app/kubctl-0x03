#!/bin/bash

echo "ğŸš€ Triggering rolling update to version 2.0..."
kubectl apply -f blue_deployment.yaml

echo "â³ Monitoring rollout..."
kubectl rollout status deployment messaging-app-blue

echo "ğŸ” Sending continuous requests to test for downtime..."
for i in {1..10}; do
  curl -s http://<minikube-ip>/api/ && echo ""
  sleep 1
done

echo "âœ… Verifying updated pods:"
kubectl get pods -l version=blue -o wide
